#!/usr/bin/env sh

set -eu

readonly rootDir=$(realpath $(dirname $(realpath $0))/../..)

if type docker > /dev/null 2>&1; then
    docker \
        run \
            -it \
            --tty \
            --rm \
            --volume "${rootDir}":/app \
            --user $(id -u):$(id -g) \
            --entrypoint /app/bin/ci/validate \
            --workdir /app \
            --env COMPOSER_HOME=/app/var/composer \
            steevanb/php-ci:latest \
            "${@}"
else
    php "${rootDir}"/bin/ci/validate.php "${@}"
fi
