#!/usr/bin/env sh

set -eu

readonly rootDir="$(realpath "$(dirname "$(realpath "$0")")/../..")"

if type docker > /dev/null 2>&1; then
    docker \
        run \
            -it \
            --rm \
            --volume "${rootDir}":/app:ro \
            --user "$(id -u)":"$(id -g)" \
            --entrypoint bin/ci/"$(basename "${0}")" \
            --workdir /app \
            steevanb/php-parallel-process:ci
else
    unused-scanner "${rootDir}"/config/ci/unused-scanner.php
fi
